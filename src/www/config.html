<!DOCTYPE html>
<!--
#-----------------------------------------------------------------------------
# Admin web-pages for the datalogger: main configuration file.
#
# Author: Bernhard Bablok
#
# Website: https://github.com/pcb-pico-datalogger
#-----------------------------------------------------------------------------
-->

<html>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

  <head>
    <!-- layout and styling thanks to purecss.io -->
    <link rel="stylesheet" href="dl_styles.css">
    <link rel="stylesheet" href="pure-min.css">

    <!-- special functions -->
    <script src="utils.js"></script>
    <!--- jquery -->
    <script src="jquery-min.js"></script>

     <script  type="text/javascript">
       window.addEventListener("load", function(event) {
         get_model();
         showTab(currentTab);
       });
     </script>
  </head>
<body>

<form class=" pure-form pure-form-aligned" id="configForm"
        action="/save_config" method="post">
  <h1>Configuration</h1>
  <!-- One "tab" for each step in the form: -->

  <div class="tab"><h2>Sensor-Box</h2>
    <fieldset>
       <legend>Names and IDs:</legend>
         <div class="pure-control-group">
           <label for="logger_name">Name:</label>
           <input  id="logger_name"
                class="pure-input-1-4 mandatory"
                placeholder="Name..."
                oninput="this.classList.remove('invalid')"
                name="LOGGER_NAME" value="Datalogger"/>
         </div>
         <div class="pure-control-group">
           <label for="logger_id">ID:</label>
           <input id="logger_id"
                class="pure-input-1-4 mandatory"
                placeholder="ID..."
                oninput="this.classList.remove('invalid')"
                name="LOGGER_ID" value="001"/>
         </div>
         <div class="pure-control-group">
           <label for="logger_loc">Location:</label>
           <input id="logger_loc"
                class="pure-input-1-4 mandatory"
                placeholder="Location..."
                oninput="this.classList.remove('invalid')"
                name="LOGGER_LOCATION" value="@Home" />
         </div>
         <div class="pure-control-group">
           <label for="logger_title">Title:</label>
           <input id="logger_title"
                class="pure-input-1-4 mandatory"
                laceholder="Title..."
                oninput="this.classList.remove('invalid')"
                name="LOGGER_TITLE" value="Datalogger 001 @Home" />
         </div>
    </fieldset>
  </div>

  <div class="tab"><h2>Sampling Mode</h2>
    <fieldset>
       <legend>Sampling mode and interval</legend>
          <div class="pure-control-group">
            <label for="cont">Continuous:</label>
            <input type="radio" class="mandatory" id="cont" name="STROBE_MODE"
                value="cont" />
            <br/>
            <label for="cont">Strobe:</label>
            <input type="radio" class="mandatory" id="strobe" name="STROBE_MODE"
                value="strobe" />
          </div>
          <div class="pure-control-group">
            <label for="interval">Sampling Interval (secs):</label>
            <input placeholder="Interval (secs)..." id="interval"
                class="mandatory" type="number" min="10" value="60"
                oninput="this.classList.remove('invalid')"
                name="INTERVAL" />
          </div>
          <table class="pure-table pure-table-bordered pure-table-striped">
            <thead>
              <tr>
                <td>Day</td>
                <td>Active</td>
                <td>H-Start</td>
                <td>H-End</td>
                <td>H-Inc</td>
                <td>M-Start</td>
                <td>M-End</td>
                <td>M-Inc</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Mo</td>
                <td><input name="d_0"  type="checkbox"/></td>
                <td><input name="hs_0" type="number" min="0" max="23"/> </td>
                <td><input name="he_0" type="number" min="0" max="23"/> </td>
                <td><input name="hi_0" type="number" min="0" max="23"/> </td>
                <td><input name="ms_0" type="number" min="0" max="59"/> </td>
                <td><input name="me_0" type="number" min="0" max="59"/> </td>
                <td><input name="mi_0" type="number" min="0" max="60"/> </td>
              </tr>
              <tr>
                <td>Tu</td>
                <td><input name="d_1"  type="checkbox"/></td>
                <td><input name="hs_1" type="number" min="0" max="23"/> </td>
                <td><input name="he_1" type="number" min="0" max="23"/> </td>
                <td><input name="hi_1" type="number" min="0" max="23"/> </td>
                <td><input name="ms_1" type="number" min="0" max="59"/> </td>
                <td><input name="me_1" type="number" min="0" max="59"/> </td>
                <td><input name="mi_1" type="number" min="0" max="60"/> </td>
              </tr>
              <tr>
                <td>We</td>
                <td><input name="d_2"  type="checkbox"/></td>
                <td><input name="hs_2" type="number" min="0" max="23"/> </td>
                <td><input name="he_2" type="number" min="0" max="23"/> </td>
                <td><input name="hi_2" type="number" min="0" max="23"/> </td>
                <td><input name="ms_2" type="number" min="0" max="59"/> </td>
                <td><input name="me_2" type="number" min="0" max="59"/> </td>
                <td><input name="mi_2" type="number" min="0" max="60"/> </td>
              </tr>
              <tr>
                <td>Th</td>
                <td><input name="d_3"  type="checkbox"/></td>
                <td><input name="hs_3" type="number" min="0" max="23"/> </td>
                <td><input name="he_3" type="number" min="0" max="23"/> </td>
                <td><input name="hi_3" type="number" min="0" max="23"/> </td>
                <td><input name="ms_3" type="number" min="0" max="59"/> </td>
                <td><input name="me_3" type="number" min="0" max="59"/> </td>
                <td><input name="mi_3" type="number" min="0" max="60"/> </td>
              </tr>
              <tr>
                <td>Fr</td>
                <td><input name="d_4"  type="checkbox"/></td>
                <td><input name="hs_4" type="number" min="0" max="23"/> </td>
                <td><input name="he_4" type="number" min="0" max="23"/> </td>
                <td><input name="hi_4" type="number" min="0" max="23"/> </td>
                <td><input name="ms_4" type="number" min="0" max="59"/> </td>
                <td><input name="me_4" type="number" min="0" max="59"/> </td>
                <td><input name="mi_4" type="number" min="0" max="60"/> </td>
              </tr>
              <tr>
                <td>Sa</td>
                <td><input name="d_5"  type="checkbox"/></td>
                <td><input name="hs_5" type="number" min="0" max="23"/> </td>
                <td><input name="he_5" type="number" min="0" max="23"/> </td>
                <td><input name="hi_5" type="number" min="0" max="23"/> </td>
                <td><input name="ms_5" type="number" min="0" max="59"/> </td>
                <td><input name="me_5" type="number" min="0" max="59"/> </td>
                <td><input name="mi_5" type="number" min="0" max="60"/> </td>
              </tr>
              <tr>
                <td>So</td>
                <td><input name="d_6"  type="checkbox"/></td>
                <td><input name="hs_6" type="number" min="0" max="23"/> </td>
                <td><input name="he_6" type="number" min="0" max="23"/> </td>
                <td><input name="hi_6" type="number" min="0" max="23"/> </td>
                <td><input name="ms_6" type="number" min="0" max="59"/> </td>
                <td><input name="me_6" type="number" min="0" max="59"/> </td>
                <td><input name="mi_6" type="number" min="0" max="60"/> </td>
              </tr>
            </tbody>
          </table>
    </fieldset>
  </div>

  <div class="tab"><h2>Hardware</h2>
    <fieldset>
       <legend>Display, UI, CSV-Filenames:</legend>
         <div class="pure-control-group">
            <label for="display">Display:</label>
            <select id="display" class="mandatory" name="HAVE_DISPLAY"
                oninput="this.classList.remove('invalid')">
              <option selected="selected">Inky-Pack</option>
              <option>None</option>
              <option>Display-Pack</option>
              <option>Ada-2.13-Mono</option>
              <option>Ada-1.54-Mono</option>
            </select>
         </div>
         <div class="pure-control-group">
           <label for="tab_ui">Tabular UI:</label>
           <input class="mandatory" type="radio" id="tab_ui" name="SIMPLE_UI"
                value="tab_ui" />
         </div>
         <div class="pure-control-group">
           <label for="cont">Simple UI:</label>
           <input class="mandatory" type="radio" id="simple_ui" name="SIMPLE_UI"
                value="simple_ui" />
         </div>
         <div class="pure-control-group">
           <label for="have_sd">SD installed:</label>
           <input class="mandatory" type="checkbox" id="HAVE_SD" name="HAVE_SD"
                checked="checked" />
         </div>
         <div class="pure-control-group">
            <label for="pattern">CSV filename pattern</label>
            <input
                placeholder="/sd/log_{ID}_{YMD}.csv" id="pattern"
                oninput="this.classList.remove('invalid')"
                name="CSV_FILENAME" value="/sd/log_{ID}_{YMD}.csv" />
         </div>
    </fieldset>
  </div>

  <div class="tab"><h2>LoRa</h2>
    <div class="pure-control-group">
      <label for="have_lora">LoRa installed:</label>
      <input class="mandatory" type="checkbox" id="HAVE_LORA" name="HAVE_LORA"
           checked="checked" />
    </div>
    <fieldset>
       <legend>LoRa Addresses:</legend>
         <div class="pure-control-group">
            <label for="lora_node">This Node:</label>
            <input type="number" min="1" max="254"
                id="lora_node" placeholder="Node Address..."
                oninput="this.classList.remove('invalid')"
                name="LORA_NODE_ADDR" value="1" />
          </div>
          <div class="pure-control-group">
            <label for="lora_base">Base Node:</label>
            <input type="number" min="0" max="254"
                id="lora_base" placeholder="Base Address..."
                oninput="this.classList.remove('invalid')"
                name="LORA_BASE_ADDR" value="0" />
         </div>
    </fieldset>

    <fieldset>
       <legend>Technical Parameters:</legend>
         <div class="pure-control-group">
            <label for="lora_enable_time">Enable Time:</label>
            <input type="number" min="0"
                id="lora_enable_time" placeholder="Enable Time..."
                oninput="this.classList.remove('invalid')"
                name="LORA_ENABLE_TIME" value="3" />
         </div>
         <div class="pure-control-group">
            <label for="lora_ack_time">Ack Time:</label>
            <input  type="number" min="0"
                id="lora_ack_time" placeholder="Ack Wait Time..."
                oninput="this.classList.remove('invalid')"
                name="LORA_ACK_WAIT" value="3" />
         </div>
         <div class="pure-control-group">
            <label for="lora_ack_retries">Ack Retries:</label>
            <input type="number" min="0" max="5" steps="1"
                id="lora_ack_retries" placeholder="Ack Retries..."
                oninput="this.classList.remove('invalid')"
                name="LORA_ACK_RETRIES" value="3" />
         </div>
         <div class="pure-control-group">
            <label for="lora_freq">Frequency:</label>
            <select id="lora_freq"
                oninput="this.classList.remove('invalid')"
                name="LORA_FREQ">
                <option>433</option>
                <option selected="selected">868</option>
                <option>915</option>
            </select>
         </div>
         <div class="pure-control-group">
            <label for="lora_tx_power">TX Power</label>
            <input type="number" min="5" max="23" step="1"
                id="lora_tx_power" placeholder="Transmit Power..."
            oninput="this.classList.remove('invalid')"
            name="LORA_TX_POWER" value="23" />
         </div>
    </fieldset>
  </div>

  <div class="tab"><h2>Sensors</h2>
    <fieldset>
       <legend>List of Sensors:</legend>
         <div style="width:100%; display:inline-flex;
              justify-content:left">
           <div style="display:inline-flex; flex-direction:column;
                       width:100%">
              <div style="display:inline-flex; flex-direction:row;">
                <label for="SENSORS" style="flex:none">Selected:</label>
                <input type="text" id="SENSORS"
                    class="mandatory" style="flex-grow:1"
                    oninput="this.classList.remove('invalid')"
                    name="SENSORS">
              </div>
              <div style="display:inline-flex;
                  align-items: baseline; flex-direction:row;">
                <label for="UL_SENSORS" style="flex:none">All:</label>
                <ul id="UL_SENSORS" class="ul_select" name="SENSORS_OPTS">
                  <li id="SENSORS_T" class="ul_sel_li"></li>
                </ul>
             </div>
           </div>
         </div>
    </fieldset>
  </div>

  <div class="tab"><h2>Tasks</h2>
    <fieldset>
       <legend>List of Tasks:</legend>
         <div style="width:100%; display:inline-flex;
              justify-content:left">
           <div style="display:inline-flex; flex-direction:column;
                       width:100%">
              <div style="display:inline-flex; flex-direction:row;">
                <label for="TASKS" style="flex:none">Selected:</label>
                <input type="text" id="TASKS"
                    class="mandatory" style="flex-grow:1"
                    oninput="this.classList.remove('invalid')"
                    name="TASKS">
              </div>
              <div style="display:inline-flex;
                  align-items: baseline; flex-direction:row;">
                <label for="UL_TASKS" style="flex:none">All:</label>
                <ul id="UL_TASKS" class="ul_select" name="TASKS_OPTS">
                  <li id="TASKS_T" class="ul_sel_li"></li>
                </ul>
             </div>
           </div>
         </div>
    </fieldset>
  </div>

  <div style="overflow:auto;">
    <div style="float:right;">
      <button type="button" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
      <button type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
    </div>
  </div>
  <!-- Circles which indicates the steps of the form: -->
  <div style="text-align:center;margin-top:40px;">
    <span class="step"></span>
    <span class="step"></span>
    <span class="step"></span>
    <span class="step"></span>
    <span class="step"></span>
    <span class="step"></span>
  </div>
</form>

</body>

</html>
